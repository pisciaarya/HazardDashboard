<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>जोखिम प्रतिबिम्ब</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <!-- CORRECTED: Path now uses url_for syntax for Flask or direct static path -->
  <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
  <nav class="main-nav">
    <a class="navbar-brand" href="/">
      <i class="fas fa-map-marked-alt"></i> जोखिम प्रतिबिम्ब
    </a>
    <ul>
      <li><a class="nav-link" href="/"><i class="fas fa-home"></i> Home</a></li>
      <li class="dropdown">
        <a class="nav-link" href="#"><i class="fas fa-layer-group"></i> Our Work <i class="fas fa-caret-down"></i></a>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="/map"><i class="fas fa-map"></i> Overview</a></li>
          <li><a class="dropdown-item" href="/map?layer=realtime"><i class="fas fa-water"></i> Real-Time Data</a></li>
          <li><a class="dropdown-item" href="/map?layer=hazards"><i class="fas fa-mountain"></i> Hazards</a></li>
          <li><a class="dropdown-item" href="/map?layer=spatial"><i class="fas fa-bolt"></i> Analysis Tools</a></li>
          <!-- <li><a class="dropdown-item" href="/map?layer=attribute"><i class="fas fa-fire"></i> Attribute Tools</a></li> -->
        </ul>
      </li>
      <li><a class="nav-link" href="/documentation"><i class="fas fa-file-alt"></i> Documentation</a></li>
      <li><a class="nav-link" href="/about"><i class="fas fa-info-circle"></i> About Us</a></li>
      <li><a class="nav-link" href="/info"><i class="fas fa-info"></i> </a></li>
      <li>
        <button id="theme-toggle" class="theme-toggle">
          <i class="fas fa-moon"></i>
        </button>
      </li>
    </ul>
  </nav>

  <section class="content-section">
    <div class="container">
      <div class="content-card">
        
        </div>
      </div>
      
      <div class="content-card">
        <h2><i class="fas fa-lightbulb"></i> Additional Features</h2>
        
        <div class="feature-option">
          <h3><i class="fas fa-code"></i> API Access</h3>
          <p>Access our data programmatically using our REST API. Get real-time hazard data in JSON format.</p>
          <div class="api-details">
            <p><strong>Endpoint:</strong> <code>/api/v1/data/{layer}</code></p>
            <p><strong>Authentication:</strong> API Key required</p>
          </div>
          <button class="btn btn-secondary api-key-btn">
            <i class="fas fa-key"></i> Request API Key
          </button>
        </div>
        
        <div class="feature-option">
          <h3><i class="fas fa-video"></i> Demonstration</h3>
          <p>Video Demonstration Walkthrough:</p>
          <ul class="tutorial-list">
            <li><a href="https://youtu.be/RHvHoyZbJrs?si=UVST0uxFV57jAMys" class="tutorial-link"><i class="fas fa-play-circle"></i> Basic Map Navigation</a></li>
          </ul>
        </div>
      </div>
      
      <div class="content-card">
        <h2><i class="fas fa-comment-alt"></i> User Feedback</h2>
        <p>We value your input to improve our platform.</p>

        <form id="feedback-form" 
        action = 'https://formspree.io/f/xdkzreor' 
        method = 'POST'>
          <div class="mb-3">
            <label for="feedback-name" class="form-label">Name (optional)</label>
            <input type="text" class="form-control" id="feedback-name" placeholder="Your name">
          </div>
          <div class="mb-3">
            <label for="feedback-email" class="form-label">Email (optional)</label>
            <input type="email" class="form-control" id="feedback-email" placeholder="your@email.com">
          </div>
          <div class="mb-3">
            <label for="feedback-type" class="form-label">Feedback Type <span class="required">*</span></label>
            <select class="form-select" id="feedback-type" required>
              <option value="">Select type</option>
              <option value="suggestion">Suggestion</option>
              <option value="bug">Bug Report</option>
              <option value="question">Question</option>
              <option value="data">Data Issue</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="feedback-message" class="form-label">Your Feedback <span class="required">*</span></label>
            <textarea class="form-control" id="feedback-message" rows="4" 
                      placeholder="Please provide detailed feedback..." required></textarea>
          </div>
          <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="followup-check">
            <label class="form-check-label" for="followup-check">Allow us to follow up with you</label>
          </div>
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-paper-plane"></i> Submit Feedback
          </button>
        </form>
        <div id="feedback-status" class="mt-3"></div>
      </div>
    </div>
  </section>

  <footer>
    <p>&copy; 2025 Vulnerability Mapping and Risk Zonation | Nepal</p>
    <p>Developed with <i class="fas fa-heart" style="color: #ff6b6b;"></i> for safer communities</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- CORRECTED: Paths now use url_for syntax for Flask or direct static path -->
  <script src="/static/js/main.js"></script>
  <script src="/static/js/theme-toggle.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const uploadForm = document.getElementById('shapefile-upload');
      if (uploadForm) {
        uploadForm.addEventListener('submit', function(e) {
          e.preventDefault();
          const statusEl = document.getElementById('upload-status');
          const fileInput = document.getElementById('shapefile');
          
          if (fileInput.files.length === 0) {
            statusEl.innerHTML = '<div class="alert alert-danger">Please select a file</div>';
            return;
          }
          
          const file = fileInput.files[0];
          if (file.size > 10 * 1024 * 1024) {
            statusEl.innerHTML = '<div class="alert alert-danger">File size exceeds 10MB limit</div>';
            return;
          }
          
          statusEl.innerHTML = '<div class="alert alert-info">Processing your file... <i class="fas fa-spinner fa-spin"></i></div>';
          
          setTimeout(() => {
            statusEl.innerHTML = `
              <div class="alert alert-success">
                <i class="fas fa-check-circle"></i> Analysis completed!
                <p>Your results are now available on the map.</p>
              </div>
            `;
            uploadForm.reset();
          }, 3000);
        });
      }

      document.querySelectorAll('.download-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const type = this.getAttribute('data-type');
          // IMPORTANT: Replaced alert() with a custom message box or modal if this were a full app,
          // but for a quick fix, keeping it as prompt/alert for now.
          // In a production app, you'd use a custom modal for user confirmation.
          if (confirm(`Download ${type} data? This may take a few moments.`)) {
            const statusEl = document.createElement('div');
            statusEl.className = 'alert alert-info mt-2';
            statusEl.innerHTML = 'Preparing download...';
            this.parentNode.appendChild(statusEl);
            
            setTimeout(() => {
              statusEl.className = 'alert alert-success mt-2';
              statusEl.innerHTML = 'Download ready! If it doesn\'t start automatically, <a href="#" class="alert-link">click here</a>';
            }, 1500);
          }
        });
      });

      const feedbackForm = document.getElementById('feedback-form');
      if (feedbackForm) {
        feedbackForm.addEventListener('submit', function(e) {
          e.preventDefault();
          const statusEl = document.getElementById('feedback-status');
          
          if (!document.getElementById('feedback-type').value || 
              !document.getElementById('feedback-message').value) {
            statusEl.innerHTML = '<div class="alert alert-danger">Please fill all required fields</div>';
            return;
          }
          
          statusEl.innerHTML = '<div class="alert alert-info">Submitting your feedback... <i class="fas fa-spinner fa-spin"></i></div>';
          
          setTimeout(() => {
            statusEl.innerHTML = `
              <div class="alert alert-success">
                <i class="fas fa-check-circle"></i> Thank you for your feedback!
                <p>We'll review your submission and respond if needed.</p>
              </div>
            `;
            feedbackForm.reset();
          }, 2000);
        });
      }

      document.querySelector('.api-key-btn')?.addEventListener('click', function() {
        // IMPORTANT: Replaced alert() and prompt() with custom message boxes/modals for production apps.
        // For quick fix, keeping it as prompt/alert for now.
        const email = prompt('Please enter your email to receive an API key:');
        if (email) {
          alert(`API key request received for ${email}. You'll receive your key shortly.`);
        }
      });
    });
  </script>
</body>
</html>
